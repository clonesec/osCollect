<%= render 'form' %>
<% unless @all_results.nil? %>
  <div class="alert alert-success">
    <a class="close" data-dismiss="alert">Ã—</a>
    Searched <%= pluralize(@all_results.sentinels.size, 'node')%> in <%=@elapsed%> seconds (actual search time was <%=@all_results.sphinx_time%>).
    <br />
    <% @all_results.log_counts.each do |lc| %>
        <%=lc[0]%>: displaying <%= number_with_delimiter(lc[2]) %> of <%= number_with_delimiter(lc[1]) %> matches<br />
    <% end %>
  </div>
  <% @all_results.errors.each do |error| %>
    <div class="alert alert-error">
      <b>Node</b>: <%= error[0] %> (<%= error[1] %>)<br />
      <%= raw "Error: #{error[3]}<br />" unless error[3].blank? %>
      <%= raw "Return code: #{error[4]}<br />" unless error[4].blank? %>
      <%= raw "HTTP response code: #{error[5]}<br />" unless error[5].blank? %>
      <%= raw "HTTP status: #{error[6]}<br />" unless error[6].blank? %>
      <%= raw "<b>Search warnings</b>: <pre>#{error[7]}</pre><br />" unless error[7].blank? %>
      <% err = error[8].blank? ? '' : error[8].gsub(': ', ":\n") %>
      <%= raw "<b>Search errors</b>: <pre>#{err.to_yaml}</pre>" unless err.blank? %>
    </div>
  <% end %>
<% end %>
